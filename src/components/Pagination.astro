---
const { totalPages = 1, currentPage = 1 } = Astro.props;

const safeTotalPages = Math.max(1, Number(totalPages) || 1);
const safeCurrentPage = Math.min(safeTotalPages, Math.max(1, Number(currentPage) || 1));
const pathname = Astro.url.pathname;

function getPageHref(page) {
	return page === 1 ? pathname : `${pathname}?page=${page}`;
}
---

<nav class="postPagination" data-pagination aria-label="포스트 페이지네이션" data-total-pages={safeTotalPages}>
	<a
		class="paginationButton"
		data-pagination-control="prev"
		href={getPageHref(Math.max(1, safeCurrentPage - 1))}
		aria-label="이전 페이지로 이동"
	>
		&lt;
	</a>

	<ul class="paginationList" data-pagination-pages>
		{
			Array.from({ length: safeTotalPages }, (_, index) => index + 1).map((page) => (
				<li>
					<a
						href={getPageHref(page)}
						data-page-link
						data-page={page}
						class:list={['paginationButton', page === safeCurrentPage && 'is-active']}
						aria-label={`${page}페이지로 이동`}
						aria-current={page === safeCurrentPage ? 'page' : 'false'}
					>
						{page}
					</a>
				</li>
			))
		}
	</ul>

	<a
		class="paginationButton"
		data-pagination-control="next"
		href={getPageHref(Math.min(safeTotalPages, safeCurrentPage + 1))}
		aria-label="다음 페이지로 이동"
	>
		&gt;
	</a>
</nav>
