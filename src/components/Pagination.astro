---
const { totalPages = 1, currentPage = 1 } = Astro.props;

const safeTotalPages = Math.max(1, Number(totalPages) || 1);
const safeCurrentPage = Math.min(safeTotalPages, Math.max(1, Number(currentPage) || 1));
const pathname = Astro.url.pathname;

function getPageHref(page) {
	return page === 1 ? pathname : `${pathname}?page=${page}`;
}
---

<nav class="postPagination" data-pagination aria-label="포스트 페이지네이션">
	{
		safeCurrentPage === 1 ? (
			<span class="paginationButton is-disabled" aria-disabled="true">&lt;&lt;</span>
		) : (
			<a class="paginationButton" href={getPageHref(1)} aria-label="첫 페이지로 이동">&lt;&lt;</a>
		)
	}

	{
		safeCurrentPage === 1 ? (
			<span class="paginationButton is-disabled" aria-disabled="true">&lt;</span>
		) : (
			<a
				class="paginationButton"
				href={getPageHref(safeCurrentPage - 1)}
				aria-label="이전 페이지로 이동"
			>
				&lt;
			</a>
		)
	}

	<ul class="paginationList" data-pagination-pages>
		{
			Array.from({ length: safeTotalPages }, (_, index) => index + 1).map((page) => (
				<li>
					<a
						href={getPageHref(page)}
						class:list={['paginationButton', page === safeCurrentPage && 'is-active']}
						aria-label={`${page}페이지로 이동`}
						aria-current={page === safeCurrentPage ? 'page' : 'false'}
					>
						{page}
					</a>
				</li>
			))
		}
	</ul>

	{
		safeCurrentPage === safeTotalPages ? (
			<span class="paginationButton is-disabled" aria-disabled="true">&gt;</span>
		) : (
			<a
				class="paginationButton"
				href={getPageHref(safeCurrentPage + 1)}
				aria-label="다음 페이지로 이동"
			>
				&gt;
			</a>
		)
	}

	{
		safeCurrentPage === safeTotalPages ? (
			<span class="paginationButton is-disabled" aria-disabled="true">&gt;&gt;</span>
		) : (
			<a
				class="paginationButton"
				href={getPageHref(safeTotalPages)}
				aria-label="마지막 페이지로 이동"
			>
				&gt;&gt;
			</a>
		)
	}
</nav>
